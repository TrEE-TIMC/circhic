.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_technical_contact_map_plot_circular_heatmap_size.py>`     to download the full example code or to run this example in your browser via Binder
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_auto_examples_technical_contact_map_plot_circular_heatmap_size.py:


==============================================
Exploring the options of the circular heatmaps
==============================================

There are several interesting options to explore for plotting heatmaps with
`circhic`. First, one can adjust the data plotted by setting the maximum inner
and outer genomic distance of the contact count being plotted. The inner
distance corresponds to the "lower triangular" matrix of the contact count
maps, an the outter distance to the upper triangular matrix. The data is thus
symmetric to the midpoint, ie the "diagonal" of the contact count matrix.

The second set of parameters that can be adjusted is the inner relates to the
size of the disk: the inner and outer radius of the disk relative to the
maximum outer radius possible (1). The outer radius will only affect how much
of the total available space is used, while the inner radius will effectively
add white space to the disk.



.. image:: /auto_examples/technical_contact_map/images/sphx_glr_plot_circular_heatmap_size_001.png
    :alt: Default, Varying data plotted on the inner genomic distance, Varying data plotted on the outer genomic distance
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/travis/build/TrEE-TIMC/circhic/circhic/utils.py:263: RuntimeWarning: invalid value encountered in true_divide
      (-inner_gdis*N/Lg+(R[iR & iS] - inner_radius) /

    (<matplotlib.image.AxesImage object at 0x7fa8d3adcfa0>, <matplotlib.axes._axes.Axes object at 0x7fa8d3a65040>)





|


.. code-block:: default

    import matplotlib.pyplot as plt
    from iced.normalization import ICE_normalization

    from circhic import datasets
    from circhic._base import CircHiCFigure


    # Load the data, compute the cumulative raw counts.
    data = datasets.load_bsubtilis()
    counts = data["counts"]
    lengths = data["nbins"]

    # Normale the data using ICE, and keep the biases
    counts, bias = ICE_normalization(counts, output_bias=True)

    # Now, create a figure with two rows and two columns
    fig, axes = plt.subplots(nrows=3, ncols=3, figsize=(8, 8))
    circhicfig = CircHiCFigure(lengths, figure=fig)


    # A basic Circular HiC plot.
    circhicfig.plot_hic(counts, ax=axes[0, 0])
    axes[0, 0].set_title("Default", fontsize="x-small", fontweight="bold")
    axes[0, 0].set_ylabel("Default inner radius", fontsize="x-small",
                          fontweight="bold", labelpad=0, zorder=10)

    # Only plotting the "upper-diagonal" contact count matrix
    circhicfig.plot_hic(counts, ax=axes[0, 1], inner_gdis=0)
    axes[0, 1].set_title("Varying data plotted on\nthe inner genomic distance",
                         fontsize="x-small", fontweight="bold")

    # Only plotting the "lower-diagonal" contact count matrix
    circhicfig.plot_hic(counts, ax=axes[0, 2], outer_gdis=0)
    axes[0, 2].set_title("Varying data plotted on\nthe outer genomic distance",
                         fontsize="x-small", fontweight="bold")

    # The same data as the first plot, but with an inner radius corresponding to
    # 25% of the available size.
    circhicfig.plot_hic(counts, inner_radius=0.25, ax=axes[1, 0])
    axes[1, 0].set_ylabel("Varing inner radius", fontsize="x-small",
                          fontweight="bold", labelpad=0, zorder=10)

    # The same data as the second plot, but with an inner radius corresponding to
    # 25% of the available size.
    circhicfig.plot_hic(counts, inner_gdis=0, inner_radius=0.25, ax=axes[1, 1])

    # The same data as the third plot, but with an inner radius corresponding to
    # 25% of the available size.
    circhicfig.plot_hic(counts, outer_gdis=0, inner_radius=0.25, ax=axes[1, 2])

    # The same data as the first plot, but with an inner radius corresponding to
    # 25% of the available size.
    circhicfig.plot_hic(counts, outer_radius=0.75, ax=axes[2, 0])
    axes[2, 0].set_ylabel("Varing outer radius", fontsize="x-small",
                          fontweight="bold", labelpad=0, zorder=10)

    # The same data as the second plot, but with an inner radius corresponding to
    # 25% of the available size.
    circhicfig.plot_hic(counts, inner_gdis=0, outer_radius=0.75, ax=axes[2, 1])

    # The same data as the third plot, but with an inner radius corresponding to
    # 25% of the available size.
    circhicfig.plot_hic(counts, outer_gdis=0, outer_radius=0.75, ax=axes[2, 2])


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  10.680 seconds)


.. _sphx_glr_download_auto_examples_technical_contact_map_plot_circular_heatmap_size.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example


  .. container:: binder-badge

    .. image:: https://mybinder.org/badge_logo.svg
      :target: https://mybinder.org/v2/gh/TrEE-TIMC/circhic/gh-pages?urlpath=lab/tree/notebooks/auto_examples/technical_contact_map/plot_circular_heatmap_size.ipynb
      :width: 150 px


  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_circular_heatmap_size.py <plot_circular_heatmap_size.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_circular_heatmap_size.ipynb <plot_circular_heatmap_size.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
