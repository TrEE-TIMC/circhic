<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>circHiC &#8212; circHiC 0.1.0.dev0 documentation</title>
  <!-- htmltitle is before nature.css - we use this hack to load bootstrap first -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet"
        href="_static/css/bootstrap.min.css"
	media="screen" />
    <script src="_static/js/jquery.js"
          type="text/javascript"></script>
  <script src="_static/js/bootstrap.min.js"
          type="text/javascript"></script>


    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery-dataframe.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport'
      content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="stylesheet"
        href="_static/css/jhepc.css"
         media="screen" />



  </head><body><div class="navbar">
      <a href="index.html">
	
      </a>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="index.html">Home</a></li>
      <li><a href="install.html">Installation</a></li>
      <li><a href="#">User Guide</a></li>
      <li><a href="modules/classes.html">API Reference</a></li>
      <li><a href="auto_examples/index.html">Gallery</a></li>
    </ul>
  </div>
    <div class="container">
  
  <div class="section" id="user-guide">
<h1>User guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="circhic-tutorial">
<h1>CircHiC tutorial<a class="headerlink" href="#circhic-tutorial" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#a-simple-circhic-plot" id="id2">A simple CircHic plot</a></p>
<ul>
<li><p><a class="reference internal" href="#using-the-defaults" id="id3">Using the defaults</a></p></li>
<li><p><a class="reference internal" href="#changing-colormap-and-border-width" id="id4">Changing colormap and border width</a></p></li>
<li><p><a class="reference internal" href="#adding-a-colorbar" id="id5">Adding a colorbar</a></p></li>
<li><p><a class="reference internal" href="#changing-the-range-of-the-colormap" id="id6">Changing the range of the colormap</a></p></li>
<li><p><a class="reference internal" href="#setting-the-range-of-genomic-distances-plotted" id="id7">Setting the range of genomic distances plotted</a></p></li>
<li><p><a class="reference internal" href="#adding-ticks-and-tick-labels" id="id8">Adding ticks and tick labels</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id1">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>CircHiC is a plotting library developped for bacterial Hi-C data. It is built
upon Matplotlib, the single most used Python package for 2D-graphics.</p>
<p>This tutorial is heavily inspired by the excellent <a class="reference external" href="https://github.com/rougier/matplotlib-tutorial">Matplotlib tutorial</a> written by Nicolas Rougier.</p>
</div>
<div class="section" id="a-simple-circhic-plot">
<h2><a class="toc-backref" href="#id2">A simple CircHic plot</a><a class="headerlink" href="#a-simple-circhic-plot" title="Permalink to this headline">¶</a></h2>
<p>In this section, we are going to plot data from <em>E. coli</em> from <a class="reference external" href="http://doi.org/10.1016/j.cell.2017.12.027">Lioy et al.
(2018) Cell, 172(4), 771–783</a>.
The data is provided as a sample dataset of <a class="reference internal" href="modules/classes.html#module-circhic" title="circhic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">circhic</span></code></a>. We will start with the
default setting and enrich the figure step by step to make it nicer and
supplement the Hi-C contact map with genomic information.</p>
<p>The first step is to load the data and the modules we will be using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">circhic</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">circhic</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_ecoli</span><span class="p">()</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;nbins&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Several datasets are included in <a class="reference internal" href="modules/classes.html#module-circhic" title="circhic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">circhic</span></code></a>, including contact maps from <em>E.
coli</em>, <em>B. subtilis</em>, a chromosome from the Human cell line KBM7, etc. All of
those datasets are accessible from the module <a class="reference internal" href="modules/classes.html#module-circhic.datasets" title="circhic.datasets"><code class="xref py py-mod docutils literal notranslate"><span class="pre">circhic.datasets</span></code></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">counts</span></code> is a NumPy ndarray of shape <code class="docutils literal notranslate"><span class="pre">(469,</span> <span class="pre">469)</span></code>.</p>
<p>Before attempting any visualization, we will normalize the data using <code class="xref py py-mod docutils literal notranslate"><span class="pre">iced</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">iced.normalization</span> <span class="kn">import</span> <span class="n">ICE_normalization</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">ICE_normalization</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="using-the-defaults">
<h3><a class="toc-backref" href="#id3">Using the defaults</a><a class="headerlink" href="#using-the-defaults" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="modules/classes.html#module-circhic" title="circhic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">circhic</span></code></a> comes with a set of default settings that are built upons
Matplotlib. These settings allow to customize almost any kind of properties:
figure size and dpi, line width, color and style, axes, axis and grid
properties, text and font properties and so on. While matplotlib defaults are
rather good in most cases, you may want to modify some properties for specific
cases.</p>
<p><a class="reference internal" href="modules/classes.html#module-circhic" title="circhic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">circhic</span></code></a> also requires to know more about the data plotted than
Matplotlib. In particular, the library requires to know the number of bins of
the Hi-C contact map. Let us instantiate a <a class="reference internal" href="modules/classes.html#module-circhic" title="circhic"><code class="xref py py-mod docutils literal notranslate"><span class="pre">circhic</span></code></a> figure by providing
the number of bins per chromosomes to the figure. You can also provide the
exact length in base pair.</p>
<p>(<a class="reference external" href="./scripts/simple_plot.py">Source code</a>, <a class="reference external" href="./scripts/simple_plot.png">png</a>, <a class="reference external" href="./scripts/simple_plot.hires.png">hires.png</a>, <a class="reference external" href="./scripts/simple_plot.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/simple_plot.png" src="_images/simple_plot.png" />
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;nbins&quot;</span><span class="p">]</span>

<span class="c1"># Now instantiate the circhic Figure</span>
<span class="n">circhicfig</span> <span class="o">=</span> <span class="n">circhic</span><span class="o">.</span><span class="n">CircHiCFigure</span><span class="p">(</span><span class="n">lengths</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>
<span class="n">circhicfig</span><span class="o">.</span><span class="n">plot_hic</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="changing-colormap-and-border-width">
<h3><a class="toc-backref" href="#id4">Changing colormap and border width</a><a class="headerlink" href="#changing-colormap-and-border-width" title="Permalink to this headline">¶</a></h3>
<p>In the script below, we have changed the default colormap used as well as the
border thickness.</p>
<p>(<a class="reference external" href="./scripts/simple_plot_colormap.py">Source code</a>, <a class="reference external" href="./scripts/simple_plot_colormap.png">png</a>, <a class="reference external" href="./scripts/simple_plot_colormap.hires.png">hires.png</a>, <a class="reference external" href="./scripts/simple_plot_colormap.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/simple_plot_colormap.png" src="_images/simple_plot_colormap.png" />
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nbins</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;nbins&quot;</span><span class="p">]</span>

<span class="c1"># Now instantiate the circhic Figure</span>
<span class="n">circhicfig</span> <span class="o">=</span> <span class="n">circhic</span><span class="o">.</span><span class="n">CircHiCFigure</span><span class="p">(</span><span class="n">lengths</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>
<span class="n">circhicfig</span><span class="o">.</span><span class="n">plot_hic</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;bone_r&quot;</span><span class="p">,</span> <span class="n">border_thickness</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-a-colorbar">
<h3><a class="toc-backref" href="#id5">Adding a colorbar</a><a class="headerlink" href="#adding-a-colorbar" title="Permalink to this headline">¶</a></h3>
<p>We are now going to add a colorbar to the plot. In order to do this, we need
to retrieve the <code class="docutils literal notranslate"><span class="pre">mappable</span></code>, ie the image, that sets the range of values. The
colorbar can either be <code class="docutils literal notranslate"><span class="pre">horizontal</span></code> or <code class="docutils literal notranslate"><span class="pre">vertical</span></code> (the default).</p>
<p>(<a class="reference external" href="./scripts/simple_plot_colorbar.py">Source code</a>, <a class="reference external" href="./scripts/simple_plot_colorbar.png">png</a>, <a class="reference external" href="./scripts/simple_plot_colorbar.hires.png">hires.png</a>, <a class="reference external" href="./scripts/simple_plot_colorbar.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/simple_plot_colorbar.png" src="_images/simple_plot_colorbar.png" />
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nbins</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;nbins&quot;</span><span class="p">]</span>

<span class="c1"># Now instantiate the circhic Figure</span>
<span class="n">circhicfig</span> <span class="o">=</span> <span class="n">circhic</span><span class="o">.</span><span class="n">CircHiCFigure</span><span class="p">(</span><span class="n">lengths</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>
<span class="n">im</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">circhicfig</span><span class="o">.</span><span class="n">plot_hic</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;bone_r&quot;</span><span class="p">,</span> <span class="n">border_thickness</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># Add the colorbar as a vertical colorbar</span>
<span class="n">cab</span> <span class="o">=</span> <span class="n">circhicfig</span><span class="o">.</span><span class="n">set_colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
<span class="n">cab</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Normalized contact counts&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title">Working with Matplotlib colorbar</p>
<p>Experienced Matplotlib users can recognized that the object returned by the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">CircHiCFig.set_colorbar</span></code> function is a Matplotlib colorbar. As such,
one can use any Matplotlib strategy to change the ticks, ticklabels, and
labels of the colorbar.</p>
</div>
</div>
<div class="section" id="changing-the-range-of-the-colormap">
<h3><a class="toc-backref" href="#id6">Changing the range of the colormap</a><a class="headerlink" href="#changing-the-range-of-the-colormap" title="Permalink to this headline">¶</a></h3>
<p>We are now going to set the minimal and maximum value of the colorbar, in
order to highlight the patterns of the contact map.</p>
<p>(<a class="reference external" href="./scripts/simple_plot_range_val.py">Source code</a>, <a class="reference external" href="./scripts/simple_plot_range_val.png">png</a>, <a class="reference external" href="./scripts/simple_plot_range_val.hires.png">hires.png</a>, <a class="reference external" href="./scripts/simple_plot_range_val.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/simple_plot_range_val.png" src="_images/simple_plot_range_val.png" />
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">circhic</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_ecoli</span><span class="p">()</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;nbins&quot;</span><span class="p">]</span>

<span class="c1"># Normalize the data using ICE, and keep the biases</span>
<span class="n">counts</span><span class="p">,</span> <span class="n">bias</span> <span class="o">=</span> <span class="n">ICE_normalization</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">output_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Now instantiate the circhic Figure</span>
<span class="n">circhicfig</span> <span class="o">=</span> <span class="n">circhic</span><span class="o">.</span><span class="n">CircHiCFigure</span><span class="p">(</span><span class="n">lengths</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>

<span class="c1"># Compute the extreme values</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">counts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span>

<span class="n">im</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">circhicfig</span><span class="o">.</span><span class="n">plot_hic</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;bone_r&quot;</span><span class="p">,</span> <span class="n">border_thickness</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                             <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>

<span class="c1"># Add the colorbar as a vertical colorbar</span>
<span class="n">cab</span> <span class="o">=</span> <span class="n">circhicfig</span><span class="o">.</span><span class="n">set_colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
<span class="n">cab</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Normalized contact counts&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-the-range-of-genomic-distances-plotted">
<h3><a class="toc-backref" href="#id7">Setting the range of genomic distances plotted</a><a class="headerlink" href="#setting-the-range-of-genomic-distances-plotted" title="Permalink to this headline">¶</a></h3>
<p>In this figure, we would like to highlight two elements: (1) the chromosomal
interaction domains (CID) (closely related to the topological associated
domains in mammifers); (2) the second diagonal highlighting the enriched
interactions between the two arms of the chromosome. We are thus going to
adjust the range of the genomic distance plotted. To highlight the chromosomal
interaction domains, we will plot only the contact counts close to the
diagonal. To highlight the second diagonal, we will plot the whole range of
contact count data. To facilitate readability, we will also set the inner
radius to a non-zero value, in order to create a “donut” shape.</p>
<p>(<a class="reference external" href="./scripts/simple_plot_gdis.py">Source code</a>, <a class="reference external" href="./scripts/simple_plot_gdis.png">png</a>, <a class="reference external" href="./scripts/simple_plot_gdis.hires.png">hires.png</a>, <a class="reference external" href="./scripts/simple_plot_gdis.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/simple_plot_gdis.png" src="_images/simple_plot_gdis.png" />
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inner_gdis</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">outer_gdis</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">inner_radius</span> <span class="o">=</span> <span class="mf">0.01</span>

<span class="n">im</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">circhicfig</span><span class="o">.</span><span class="n">plot_hic</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;bone_r&quot;</span><span class="p">,</span> <span class="n">border_thickness</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                             <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">inner_radius</span><span class="o">=</span><span class="n">inner_radius</span><span class="p">,</span>
                             <span class="n">inner_gdis</span><span class="o">=</span><span class="n">inner_gdis</span><span class="p">,</span> <span class="n">outer_gdis</span><span class="o">=</span><span class="n">outer_gdis</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-ticks-and-tick-labels">
<h3><a class="toc-backref" href="#id8">Adding ticks and tick labels</a><a class="headerlink" href="#adding-ticks-and-tick-labels" title="Permalink to this headline">¶</a></h3>
<p>Now that the contact map displays the two features we are interested in, it is
time to add ticks and tick labels to the plot.</p>
<p>(<a class="reference external" href="./scripts/simple_plot_ticks.py">Source code</a>, <a class="reference external" href="./scripts/simple_plot_ticks.png">png</a>, <a class="reference external" href="./scripts/simple_plot_ticks.hires.png">hires.png</a>, <a class="reference external" href="./scripts/simple_plot_ticks.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/simple_plot_ticks.png" src="_images/simple_plot_ticks.png" />
</div>
<p>And here is the entire code to reproduce this plot!</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">circhic</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">iced.normalization</span> <span class="kn">import</span> <span class="n">ICE_normalization</span>


<span class="c1"># Start by loading the data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">circhic</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_ecoli</span><span class="p">()</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">]</span>
<span class="n">nbins</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;nbins&quot;</span><span class="p">]</span>

<span class="c1"># Normalize the data using ICE, and keep the biases</span>
<span class="n">counts</span><span class="p">,</span> <span class="n">bias</span> <span class="o">=</span> <span class="n">ICE_normalization</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">output_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="c1"># Now instantiate the circhic Figure</span>
<span class="n">circhicfig</span> <span class="o">=</span> <span class="n">circhic</span><span class="o">.</span><span class="n">CircHiCFigure</span><span class="p">(</span><span class="n">lengths</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>

<span class="c1"># Compute the extreme values</span>
<span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">counts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
               <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">counts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
<span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="n">counts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span>

<span class="c1"># define the inner genomid distances and the outer genomic distance plotted</span>
<span class="n">inner_radius</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">inner_gdis</span><span class="p">,</span> <span class="n">outer_gdis</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">60</span>

<span class="n">im</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">circhicfig</span><span class="o">.</span><span class="n">plot_hic</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;bone_r&quot;</span><span class="p">,</span> <span class="n">border_thickness</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                             <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">inner_radius</span><span class="o">=</span><span class="n">inner_radius</span><span class="p">,</span>
                             <span class="n">inner_gdis</span><span class="o">=</span><span class="n">inner_gdis</span><span class="p">,</span> <span class="n">outer_gdis</span><span class="o">=</span><span class="n">outer_gdis</span><span class="p">)</span>

<span class="c1"># Add the colorbar as a vertical colorbar</span>
<span class="n">cab</span> <span class="o">=</span> <span class="n">circhicfig</span><span class="o">.</span><span class="n">set_colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">)</span>
<span class="n">cab</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Normalized contact counts&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">)</span>

<span class="c1"># Now, let us add the ticks and tick labels</span>
<span class="n">ticklabels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">kb&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">500</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>
<span class="n">tickpositions</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>
<span class="n">ticklabels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;OriC&quot;</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">circhicfig</span><span class="o">.</span><span class="n">set_genomic_ticklabels</span><span class="p">(</span>
    <span class="n">tickpositions</span><span class="o">=</span><span class="n">tickpositions</span><span class="p">,</span>
    <span class="n">ticklabels</span><span class="o">=</span><span class="n">ticklabels</span><span class="p">,</span>
    <span class="n">outer_radius</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;fontsize&#39;</span><span class="p">:</span> <span class="s2">&quot;small&quot;</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">)</span>

<span class="n">rax</span> <span class="o">=</span> <span class="n">circhicfig</span><span class="o">.</span><span class="n">plot_raxis</span><span class="p">()</span>
<span class="n">rax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="s2">&quot;200kb&quot;</span><span class="p">,</span> <span class="s2">&quot;0kb&quot;</span><span class="p">,</span> <span class="s2">&quot;60kb&quot;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">)</span>

<span class="n">rax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Genomic distance&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">,</span>
               <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">rax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
<footer class="footer">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2020, circHiC contributors.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.1.1.<br/>
    </p>
</footer>
  </body>
</html>